"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const nock_1 = (0, tslib_1.__importDefault)(require("nock"));
const snakecase_keys_1 = (0, tslib_1.__importDefault)(require("snakecase-keys"));
const resources_1 = require("../../api/resources");
const TestBackendAPI_1 = require("../TestBackendAPI");
test('createEmail() sends an email', async () => {
    const fromEmailName = 'accounting';
    const emailAddressId = 'idn_whatever';
    const subject = 'Your account is in good standing!';
    const body = 'Click <a href="https://www.knowyourmeme.com/">here</a> to see your most recent transactions.';
    (0, nock_1.default)('https://api.clerk.dev')
        .post('/v1/emails', (0, snakecase_keys_1.default)({
        fromEmailName,
        emailAddressId,
        subject,
        body,
    }))
        .replyWithFile(200, __dirname + '/responses/createEmail.json', {
        'Content-Type': 'application/x-www-form-urlencoded',
    });
    const email = await TestBackendAPI_1.TestBackendAPIClient.emails.createEmail({
        fromEmailName,
        emailAddressId,
        subject,
        body,
    });
    const expected = new resources_1.Email({
        id: 'ema_yeehaw',
        fromEmailName,
        toEmailAddress: 'chuck@norris.com',
        emailAddressId,
        subject,
        body,
        status: 'queued',
    });
    expect(email).toEqual(expected);
});
