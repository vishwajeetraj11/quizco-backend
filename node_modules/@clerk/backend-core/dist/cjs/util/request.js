"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkCrossOrigin = void 0;
function checkCrossOrigin(origin, initialHost, forwardedHost, port) {
    origin = origin === null || origin === void 0 ? void 0 : origin.trim().replace(/(^\w+:|^)\/\//, '');
    if (!origin) {
        return false;
    }
    if (!initialHost.startsWith('http://') &&
        !initialHost.startsWith('https://')) {
        initialHost = `https://${initialHost}`;
    }
    const hostURL = new URL(initialHost);
    if (!forwardedHost) {
        forwardedHost = hostURL.hostname;
    }
    if (!port) {
        port = hostURL.port;
    }
    if (port && port !== '80' && port !== '443') {
        forwardedHost = `${forwardedHost}:${port}`;
    }
    return origin !== forwardedHost;
}
exports.checkCrossOrigin = checkCrossOrigin;
